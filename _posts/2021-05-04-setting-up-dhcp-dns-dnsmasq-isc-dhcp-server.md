---
layout: post
title: Налаштування dhcp та dns з допомогою dnsmasq та isc-dhcp-server
date: 2021-05-04
categories: DevOps Networks Linux
---

# Теорія

**DHCP** (Dynamic Host Configuration Protocol) — це стандартний протокол прикладного рівня (7 рівень системи OSI), який дозволяє комп'ютерам автоматично отримувати IP-адресу та інші параметри, необхідні для роботи в мережі.

**DNS** (Domain Name System) або система доменних імен - ієрархічна система серверів, що дозволяє перетворити IP адресу комп'ютера чи будь-якого іншого пристрою у мережі у зручну для людини форму.

**DNSMASQ** - це легкий dhcp та dns сервер, який створений для невеликих мереж (до 1000 клієнтів) і може бути використаний на роутерах чи system-on-a-chip пристроях. Також забезпечує іменами локальні машини, які не мають глобальних DNS-записів.

# Задача

Припустимо у нас є три віртуальні машини VirtualBox. VM1 має два мережевих адаптери: перший NAT, другий Internal. VM2 та VM3 мають тільки Internal. Наша задача підняти dhcp сервер на VM1 та автоматично роздавати IP на VM2 та VM3. А також підняти dns для доступу у інтернет.

# Практика

### DNSMASQ

Дана задача виконується на "ванільному" Ubuntu server 16.04, тому всі дії будуть актальні для цієї ситеми, хоч і не виключено, що також працюватимуть і у інших дистрибутивах.

1. Встановимо dnsmasq

`sudo apt update && sudo apt install dnsmasq`

2. Можемо перевірити чи сервер запущений і працює командою 

`systemctl status dnsmasq` або `ps aux | grep dnsmasq`

3. Спершу внесемо мережевий інтефейс на якому буде працювати dnsmasq та діапазон адресів, які можуть бути призначені

`sudo vim /etc/dnsmasq.conf`

![dnsmasq-2021-05-05-1.png]({{ site.baseurl }}/images/dnsmasq-2021-05-04-1.png)

![dnsmasq-2021-05-05-2.png]({{ site.baseurl }}/images/dnsmasq-2021-05-04-2.png)


